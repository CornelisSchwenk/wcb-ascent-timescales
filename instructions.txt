# Instructions for Reproducing Results

Author: Cornelis Schwenk  
Date: 10.10.2024  
Location: Mainz  
Email: c.schwenk@uni-mainz.de  
Affiliation: JGU Mainz  

---

## Overview

These instructions detail the steps required to reproduce the results from our 2024 paper:

Title: "The Role of Ascent Timescale for WCB Moisture Transport into the UTLS"

The following sections outline the necessary steps for data analysis and visualization 
using Julia and Python.

## Prerequisites

- Julia Version: 1.10.0
- Ensure you have the required computational resources:
  - Minimum: 64 GB of RAM
  - Estimated Runtime: 2 hours for plotting
- Downloaded and unzipped the file downloaded from 10.5281/zenodo.13913564

## Steps for Data Analysis and Plotting with Julia

1. **Install Julia Packages**
   - Navigate to the `julia_code/` directory.
   - Run the following command to install the necessary Julia packages:
     ```
     julia --project=. install_packages.jl
     ```

2. **Create Normalized WCB Variables File**
   - Execute the following command to generate `WCB_tau_vars_normed.nc`:
     ```
     julia --project=. make_normed_file.jl
     ```

3. **Generate Plots**
   - Run the two scripts to create the necessary plots:
     ```
     julia --project=. make_plots.jl
     julia --project=. pyplots.jl
     ```
   - Note: The first script is computationally intensive; ensure you have sufficient 
     memory and processing time.

## Steps for Creating Figure 3 with Python

1. **Navigate to the Python Code Directory**
   - Change to the `python_code/` directory.

2. **Install Python Dependencies**
   - Execute the following command to install the required packages:
     ```
     pip install -r requirements.txt
     ```

3. **Run the Plotting Script**
   - Generate Figure 3 by running:
     ```
     python plot_Fig3.py
     ```
---

---------------------------------------------------------------------------
The following instructions can only be completed if the Eulerian data is available. 
Contact us if you require this data and read `information_ICON_data.txt`.
The instructions will create the files

	- PECR.nc
	- WCB_tau_vars_realtime.nc
	- WCB_tau_vars_normed.nc

the first two of which we have already provided in zenodo. It will also do the 
mean wind shear calculation. 

---------------------------------------------------------------------------
                   Contact Information
---------------------------------------------------------------------------

For assistance with the data download, please contact:
- Cornelis Schwenk: coschwen@uni-mainz.de
- Annete Miltenberger: amiltenb@uni-mainz.de
---------------------------------------------------------------------------

1. **Replace paths to downloaded Eulerian ICON output**
    - Replace "path/to/icon/output/" in the following scripts:
	- julia_code/WCB_selection.jl                   (line 40)
	- julia_code/pyplots.jl                         (line 11)
	- julia_code/calculate_mean_wind_shear.jl       (line 16)
	- python_code/plot_Fig3.py                      (line 16)
	- EXECUTE_WCB_SELECTION/merge_and_sum.sh        (line 46)
 
2. **Do WCB selection**
    - Navigate to the `EXECUTE_WCB_SELECTION/` directory.
    - Execute the following command (on MOGON-II supercomputer):
	```
	sbatch mogon_merge_and_WCB_sel.slurm
	```

3. **Do wind shear calculation**
    - Navigate to the `EXECUTE_WIND_SHEAR_CALCULATION/` directory.
    - Execute the following command (on MOGON-II supercomputer):
	```
	sbatch do_calc_mean_wind_shear_mogon.slurm
	```

4. **Write PECR.nc file**
    - Navigate to the `julia_code/` directory
    - Execute the following command
	```
	julia --project=. write_PECR.jl
	```
